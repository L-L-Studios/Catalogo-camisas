<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.cdnfonts.com/css/avenir" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/regular/style.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css">

    <script src="js/supabase.js" defer></script>
                
    <!--Enlaces-->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/style_navbar.css">
    <link rel="stylesheet" href="css/style_catalogo.css">
    <link rel="stylesheet" href="css/style_contacto.css">

    <link rel="stylesheet" href="css/style_tarjeta.css">
    <link rel="stylesheet" href="css/style_tarjeta-index.css">
    <link rel="stylesheet" href="css/style_tarjeta-nfound.css">

    <link rel="stylesheet" href="css/style-notif.css">

    <link rel="stylesheet" href="css/style_carrito.css">

    <link rel="website icon" href="images/website-2.svg">
    <title>Camisas</title>

</head>

<body>

    <nav id="navbar">
        <!-- Parte superior: Logo + Hamburger -->
        <div class="nav-top">
            <div class="logo">
                <svg id="logo-vrx-nabvar" data-name="Capa 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88.69 34.37">
                <g id="Capa_1-2" data-name="Capa 1">
                    <g>
                    <g>
                        <path d="m86.37,0h-8.68c-6.56,9.32-13.12,18.64-19.68,27.96h5.84l16.47-23.35c.62-.96,1.26-1.62,1.74-2.04.89-.78,1.79-1.27,3-1.92.53-.28.98-.5,1.29-.66Z"/>
                        <path d="m72.49,5.68c-.65,1.41-2.03,2.24-3.38,2.1-.88-.09-1.54-.62-2.21-1.32-1.1-1.15-2.77-3.17-4.25-6.47h-5.32c1.89,2.94,3.77,5.89,5.66,8.83.35.34,1.17,1.05,2.44,1.33,1.36.31,2.45-.03,2.93-.21,2.63-.95,3.85-3.62,4.13-4.28Z"/>
                        <path d="m70.87,18.84c.65-1.41,2.03-2.24,3.38-2.1,1.03.11,1.77.84,2.21,1.32,2.75,3.03,5.79,7.72,6.78,9.29h5.46c-2.43-3.58-4.86-7.16-7.29-10.74-.5-.74-1.16-1.36-1.96-1.75-.43-.21-.94-.39-1.52-.49-.34-.06-1.56-.29-2.93.21-2.63.95-3.85,3.62-4.13,4.28Z"/>
                    </g>
                    <path d="m22.62,0h0c.7.63.94,1.62.61,2.5-2.05,5.35-4.09,10.7-6.14,16.05-2.16-5.31-4.32-10.62-6.48-15.93-.3-.74-.19-1.58.29-2.22l.3-.39H0c1.58.46,3.16.91,4.74,1.37.41.15.73.46.9.86,1.88,4.53,3.76,9.06,5.64,13.59.22.52-.08,1.12-.63,1.26l-3.14.82,4.19,1.05c.79.2,1.45.75,1.79,1.49,1.2,2.63,2.39,5.26,3.59,7.89v.18c1.2-2.63,2.39-5.26,3.59-7.89.34-.74.99-1.29,1.79-1.49l4.19-1.05-3.14-.82c-.55-.14-.84-.74-.63-1.26l5.36-12.9c.35-.84,1.03-1.49,1.88-1.81l3.46-1.29h-10.95Z"/>
                    <path d="m38.05,0l-6.56,4.5c-1.08,2.79-.83,4.87-.57,6,.25,1.06.69,2.02.89,1.98.28-.05-.25-1.93.58-4.01.25-.61.74-1.84,1.75-2.1.99-.26,2.33.36,2.33.83-.01,6.4-.02,12.79-.03,19.19l4.54-.02c0-7.13-.01-14.26-.02-21.39-.24-.18-.58-.4-1.01-.59-1.57-.68-3.43-.4-3.43-.4,0,0,0,0,0,0,.76-.1,1.93-.23,3.36-.29,1.08-.05,1.89-.04,2.39-.03,3.29.04,7.47.17,8.46.2,2.03,1.32,2.98,3.49,2.7,5.3-.31,1.97-1.86,3.04-2.2,3.28-1.96,1.36-4.27,1-5.64.59-.85-.26-1.8.02-2.37.71-.65.79-1.33,1.9-1.56,3.33-.11.67-.1,1.28-.04,1.8.12-.35.56-1.48,1.75-2.2.78-.48,1.54-.57,1.93-.58,2.87,4.67,5.75,9.35,8.62,14.02l8.26,4.26c-3.83-5.94-7.65-11.89-11.48-17.83,3.79-.69,6.67-3.78,7.06-7.51.41-3.99-2.13-7.82-6.07-9.03h-13.63Z"/>
                    </g>
                </g>
                </svg>

            </div>

            <button class="menu" id="navbarToggler" aria-label="Main Menu">
                <svg width="45" height="45" viewBox="0 0 100 100">
                    <path class="line line1"
                        d="M 20,29.000046 H 80.000231 C 80.000231,29.000046 94.498839,28.817352 
                        94.532987,66.711331 94.543142,77.980673 90.966081,81.670246 
                        85.259173,81.668997 79.552261,81.667751 75.000211,74.999942 
                        75.000211,74.999942 L 25.000021,25.000058" />
                    
                    <path class="line line2" d="M 20,50 H 80" />

                    <path class="line line3"
                        d="M 20,70.999954 H 80.000231 C 80.000231,70.999954 
                        94.498839,71.182648 94.532987,33.288669 94.543142,22.019327 
                        90.966081,18.329754 85.259173,18.331003 79.552261,18.332249 
                        75.000211,25.000058 75.000211,25.000058 L 25.000021,74.999942" />
                </svg>
            </button>
        </div>

        <!-- Buscador (debajo de logo+hamburger en móvil) -->
        <div class="nav-buscar">
            <div class="input__container"> 
                <div class="shadow__input"></div>
                <div class="input__button__shadow">
                    <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" height="20px" width="20px">
                        <path d="M4 9a5 5 0 1110 0A5 5 0 014 9zm5-7a7 7 0 104.2 12.6.999.999 0 00.093.107l3 3a1 1 0 001.414-1.414l-3-3a.999.999 0 00-.107-.093A7 7 0 009 2z" fill-rule="evenodd" fill="#f6fffe"></path>
                    </svg>
                </div>
                <input type="text" name="text" class="input__search" placeholder="Buscar camisas...">
            </div>
        </div>

        <!-- Menú popup (Catálogo + Contacto) MOVIL-->
        <div class="nav-popup" id="navPopup">
            <a href="#catalogo" class="popup-link">Catálogo</a>
            <button class="popup-contacto">Contacto: Pedido personalizado</button>
            <button class="popup-carrito">Pedido normal <i class="ph ph-shopping-cart"></i> <span class="contador">0</span> </button>
            
        </div>

        <!-- Categorías SIN FONDO (separadas de la navbar) -->
       <div class="nav-categorias-wrapper">
            <div class="nav-categorias">
                <!-- Botón "Todas" siempre presente -->
                <button class="btn-cat active" data-cat="todas">Todas</button>
                <!-- Las demás categorías se insertarán dinámicamente aquí -->
            </div>
        </div>

        <!-- Enlaces para desktop (ocultos en móvil) -->
        <div class="nav-links-desktop">
            <a href="#catalogo">Catálogo</a>
            <a href="#contact">Contacto: Pedido personalizado</a>
            <button class="btn-carrito"> Pedido normal <i class="ph ph-shopping-cart"></i> <span class="contador">0</span> </button>
        </div>
    </nav>

    <main>
        <div class="content-camisas"> 
            <section class="catalogo" id="catalogo">

                <div class="contenedor">

                    <div class="row-info-catalogo">

                    <!-- IZQUIERDA — TEXTO DEL CATÁLOGO -->
                    <div class="info-cat-left">
                        <h2 class="lbl-catalogo">Catálogo de camisas</h2>

                        <p class="lbl-desc-cat">
                        Selecciona las camisas de tu preferencia <strong>desde dentro de cada tarjeta</strong>, 
                        eligiendo talla, color y cantidad. <br>
                        Puedes quitarlas en cualquier momento presionando nuevamente el ícono de la camisa.
                        <span class="icono-desc-cat">
                            <svg viewBox="0 0 512 512" width="20" height="20">
                                <path d="M499.453,116.763L343.871,59.708c-5.406-1.985-11.41-1.43-16.361,1.508
                                c0,0-4.04,42.46-71.51,42.46s-71.51-42.46-71.51-42.46c-4.951-2.938-10.954-3.492-16.354-1.508
                                l-155.59,57.056c-9.098,3.329-14.262,12.946-12.028,22.364l16.197,68.416
                                c2.148,9.048,10.478,15.237,19.761,14.689l61.864-3.678v206.77
                                c0,15.543,12.598,28.14,28.134,28.14h259.052
                                c15.535,0,28.133-12.598,28.133-28.14v-206.77l61.865,3.678
                                c9.283,0.548,17.612-5.641,19.761-14.689l16.197-68.416
                                c2.234-9.418-2.93-19.035-12.028-22.364z" />
                            </svg>
                        </span>
                        </p>
                    </div>

                    <!-- DERECHA — MINICARD -->
                    <div class="info-cat-right">
                        <div class="card-prox shadow-sm">

                        <span class="notiglow"></span>
                        <span class="notiborderglow"></span>

                        <h4 class="lbl-prox">Entrega de pedido próximamente:</h4>

                        
                        <div class="icon-prox">

                           <p class="txt-prox" id="texto-proxima-entrega">
                                Cargando fecha...
                            </p>

                            <svg fill="#000000" width="40px" height="40px" viewBox="0 0 32 32" data-name="Layer 4" id="Layer_4" xmlns="http://www.w3.org/2000/svg"><title/><path d="M30,15.5a0.5,0.5,0,0,0-.5.5A13.52,13.52,0,1,1,28,9.86l-1.44-.38a0.51,0.51,0,0,0-.61.35,0.5,0.5,0,0,0,.35.61l2.56,0.68,0.13,0a0.5,0.5,0,0,0,.48-0.37l0.67-2.49a0.5,0.5,0,0,0-.35-0.61,0.51,0.51,0,0,0-.61.35L28.85,9.29A14.49,14.49,0,1,0,30.5,16,0.5,0.5,0,0,0,30,15.5Z"/><ellipse cx="4.06" cy="16" rx="0.94" ry="0.93"/><ellipse cx="16" cy="4.07" rx="0.94" ry="0.93"/><ellipse cx="27.94" cy="16" rx="0.94" ry="0.93"/><ellipse cx="16" cy="27.93" rx="0.94" ry="0.93"/><path d="M10.64,21.27a0.5,0.5,0,0,0,.71,0l5-4.92A0.5,0.5,0,0,0,16.5,16l0-8.66a0.5,0.5,0,0,0-.5-0.5h0a0.5,0.5,0,0,0-.5.5l0,8.45-4.85,4.77A0.5,0.5,0,0,0,10.64,21.27Z"/></svg>
                        </div>

                        </div>
                    </div>

                </div>
                
                    <!-- GRID CATÁLOGO - AHORA SOLO UN SCRIPT -->
                    <div id="section-catalogo-completo"></div>
                    
                </div>

            </section>

            <!--ZONA CONTACTO-->
            <section id="contact" class="white reveal">
            <div class="blob-section alt" aria-hidden></div>

            <h2 class="section-title">CONTACTO: Pedidos Personalizados</h2>
            <p class="section-sub">¿Te gustaría encargar camisas personalizadas con nosotros?
                Escribénos por este medio ó WhatsApp.</p>

            <div class="contact-grid">

                <!-- IZQUIERDA/ FORM PARA ENVIAR CAMISAS ENCARGADAS -->
                <div>
                    <div class="contact-box">
                    <h3>Envíanos un mensaje</h3>
                    <form method="POST" id="contactForm">

                        <div class="form-grid">

                            <!-- FORMULARIO LADO IZQUIERDO-->
                            <div class="form-izq">

                                <input type="text" name="name" placeholder="Tu nombre" />
                                <small class="error-msg"></small>

                                <input type="email" name="email" placeholder="Tu correo" />
                                <small class="error-msg"></small>

                                <textarea name="message" placeholder="Tu pedido personalizado (Detalles)" rows="6"></textarea>
                                <small class="error-msg"></small>

                            </div>

                            <!-- FORMULARIO LADO DERECHO-->
                            <div class="form-der">

                            <!-- IMAGEN-->
                                <div class="img-upload-contact">

                                    <label for="input-img" class="img-box" id="img-box">
                                        <span class="img-placeholder">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
                                            <path d="M4 16l4-4 4 4 4-4 4 4" stroke="currentColor" stroke-width="2"/>
                                            <rect x="3" y="3" width="18" height="18" rx="3" stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                        <p>Seleccionar imagen de referencia</p>
                                        </span>
                                        <img id="preview-img" hidden>
                                    </label>

                                    <input 
                                        type="file"
                                        id="input-img"
                                        accept="image/*"
                                        hidden
                                    >

                                </div>
                                <small class="error-msg"></small>

                                <!-- TALLAS-->
                                <div class="card border-0 bg-light mb-4 card-tallas">
                                    <div class="card-body">
                                        <p class="text-muted small mb-3">Selecciona la talla para tu camisa personalizada</p>
                                        
                                        <!-- Contenedor de tallas -->
                                        <div class="d-flex gap-2 flex-wrap" id="tallas">
                                            <div class="talla" data-talla="S">S</div>
                                            <div class="talla" data-talla="M">M</div>
                                            <div class="talla" data-talla="L">L</div>
                                            <div class="talla" data-talla="XL">XL</div>
                                            <div class="talla" data-talla="XXL">XXL</div>
                                            <div class="talla" data-talla="XXXL">XXXL</div>
                                        </div>
                                        
                                        <!-- Input oculto para almacenar la talla seleccionada -->
                                        <input type="hidden" name="talla" id="talla-input" value="">
                                        
                                        <!-- Mensaje de error para talla -->
                                        <small class="error-msg" id="talla-error"></small>
                                        
                                        <!-- Mostrar talla seleccionada -->
                                        <div class="talla-seleccionada-display" id="talla-seleccionada-display">
                                            <strong>Talla seleccionada:</strong> 
                                            <span id="talla-seleccionada-text"></span>
                                            <button type="button" class="btn btn-sm btn-link p-0 ms-2" id="cambiar-talla">
                                                <small>Cambiar</small>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                            <input type="hidden" name="_confirmation" value="true">

                            <!-- Honeypot anti-spam -->
                            <input type="text" name="_gotcha" style="display:none">

                            <!-- Mensaje de bloqueo -->
                            <p id="formStatus" style="display:none;"></p>

                            <button type="submit" id="btn-enviar">Enviar</button>


                    </form>

                    </div>
                </div>

                <!-- DERECHA (IMAGEN + CUADRO BLANCO) -->
                <div class="contact-image-wrap">
                    <img src="images/img-catalogo-camisas-ropero.png" alt="Contacto" class="contact-image">

                    <div class="contact-image-card">
                        <!-- iconos de redes sociales -->
                        <div class="card-redes">
                            <a>
                                <svg class="socialSvg" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="M11.99121,1.00044a10.61443,10.61443,0,0,0-11,10.70019,10.46132,10.46132,0,0,0,3.41406,7.86524L4.457,21.2563a1.79959,1.79959,0,0,0,1.79883,1.74316,1.81992,1.81992,0,0,0,.72656-.15234l1.9209-.84668a11.89548,11.89548,0,0,0,3.08789.40039,10.61525,10.61525,0,0,0,11.001-10.7002A10.61525,10.61525,0,0,0,11.99121,1.00044Zm0,19.40039a9.86205,9.86205,0,0,1-2.63476-.35059,1.79856,1.79856,0,0,0-1.19629.0918l-1.71387.75586-.04492-1.49316a1.80968,1.80968,0,0,0-.60157-1.27442,8.4876,8.4876,0,0,1-2.80859-6.42969,8.65949,8.65949,0,0,1,9-8.70019,8.70522,8.70522,0,1,1,0,17.40039ZM15.72559,8.5854l-2.3125,2.75488L10.06641,9.28364a.99809.99809,0,0,0-1.28907.21L5.72559,13.13032a.99955.99955,0,1,0,1.53125,1.28516l2.498-2.97559,3.34668,2.05567a.99823.99823,0,0,0,1.28906-.209l2.86622-3.416A.99955.99955,0,1,0,15.72559,8.5854Z"/></svg>

                                <svg class="socialSvg" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="M11.99121,1.00044a10.61443,10.61443,0,0,0-11,10.70019,10.46132,10.46132,0,0,0,3.41406,7.86524L4.457,21.2563a1.79959,1.79959,0,0,0,1.79883,1.74316,1.81992,1.81992,0,0,0,.72656-.15234l1.9209-.84668a11.89548,11.89548,0,0,0,3.08789.40039,10.61525,10.61525,0,0,0,11.001-10.7002A10.61525,10.61525,0,0,0,11.99121,1.00044Zm0,19.40039a9.86205,9.86205,0,0,1-2.63476-.35059,1.79856,1.79856,0,0,0-1.19629.0918l-1.71387.75586-.04492-1.49316a1.80968,1.80968,0,0,0-.60157-1.27442,8.4876,8.4876,0,0,1-2.80859-6.42969,8.65949,8.65949,0,0,1,9-8.70019,8.70522,8.70522,0,1,1,0,17.40039ZM15.72559,8.5854l-2.3125,2.75488L10.06641,9.28364a.99809.99809,0,0,0-1.28907.21L5.72559,13.13032a.99955.99955,0,1,0,1.53125,1.28516l2.498-2.97559,3.34668,2.05567a.99823.99823,0,0,0,1.28906-.209l2.86622-3.416A.99955.99955,0,1,0,15.72559,8.5854Z"/></svg>
                            </a>

                            <a>
                                <svg class="socialSvg" viewBox="0 0 16 16">
                                <path
                                    d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"
                                ></path>
                                </svg>
                                <svg class="socialSvg" viewBox="0 0 16 16">
                                <path
                                    d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"
                                ></path>
                                </svg>
                            </a>
                        </div>

                    </div>
                </div>

            </div>
            </section>


        </div>
        
    </main>


    <!-- SIDEBAR CARRITO CORREGIDO -->
    <div id="carritoSidebar" class="carrito-sidebar">
        <div class="carrito-header">
            <h3>Tu Pedido</h3>
            <button id="cerrarCarrito">&times;</button>
        </div>

        <div class="carrito-body">
            <div id="listaCarrito"></div>
        </div>

        <div class="carrito-footer">
            <div class="carrito-datos">
                <input type="text" id="pedidoNombre" placeholder="Nombre completo">
                <input type="email" id="pedidoEmail" placeholder="Correo">
                <input type="text" id="pedidoDireccion" placeholder="Dirección de entrega (calle, colonia, referencias)">
                <input type="tel" id="pedidoWhatsapp" placeholder="WhatsApp">

                <select id="pedidoPago">
                    <option value="efectivo">Pago en efectivo</option>
                </select>
            </div>

            <p>Total: $<span id="totalCarrito">0.00</span></p>
            <button id="btnPedidoCarrito" class="btn-pedido">
                Realizar pedido
            </button>
        </div>
    </div>

    <div id="carritoOverlay" class="carrito-overlay"></div>

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!--  -->
    <script src="js/supabase.js"></script>
    <script src="js/nabvar.js"></script>
    <script src="js/catalogo.js"></script> 
    <script src="js/bookmarks.js"></script>

    <script src="js-pedido/producto-personalizado.js"></script>

 <!--   <script src="js/form-camisas.js"></script>
    <script src="js/form-notif.js"></script>
    <script src="js/form-val.js"></script>-->

    <script src="js/carrito-sidebar.js"></script>

    <script src="js-pedido/enviar-correo.js"></script>

    <script src="js-pedido/pedido_camisa_supabase.js"></script>

<!-- Código del usuario - MEJORADO -->
<script>
(async () => {
    while (!window.supabase) {
        await new Promise(r => setTimeout(r, 100));
    }

    const el = document.getElementById("texto-proxima-entrega");
    
    // Función para cargar y mostrar la fecha
    async function cargarFechaProxima() {
        try {
            const { data, error } = await supabase
                .from("config_tienda")
                .select("proxima_entrega")
                .eq("id", 1)
                .single();

            if (error) throw error;

            if (!data?.proxima_entrega) {
                el.textContent = "Próximamente";
                return;
            }

            const fechaStr = data.proxima_entrega;
            const fechaLocal = new Date(fechaStr + 'T00:00:00');

            const hoy = new Date();
            
            // Ajustar ambas fechas a medianoche local para comparación correcta
            const hoyAjustado = new Date(hoy.getFullYear(), hoy.getMonth(), hoy.getDate());
            const fechaAjustada = new Date(fechaLocal.getFullYear(), fechaLocal.getMonth(), fechaLocal.getDate());
            
            const diffTime = fechaAjustada - hoyAjustado;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            console.log("Fecha en BD:", fechaStr);
            console.log("Fecha interpretada:", fechaLocal.toLocaleDateString());
            console.log("Diferencia de días:", diffDays);
            
            if (diffDays < 0) {
                el.textContent = "Fecha pasada - actualizar en administración";
            } else if (diffDays === 0) {
                el.textContent = "¡Hoy!";
            } else if (diffDays === 1) {
                el.textContent = "Mañana";
            } else if (diffDays <= 7) {
                el.textContent = `En ${diffDays} días`;
            } else {
                // Mostrar fecha completa
                el.textContent = fechaLocal.toLocaleDateString('es-ES', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
            
        } catch (error) {
            console.error("Error cargando fecha:", error);
            el.textContent = "Próximamente";
        }
    }

    // Cargar fecha inicial
    cargarFechaProxima();

    // ✅ Escuchar cambios en localStorage
    if (window.addEventListener) {
        window.addEventListener('storage', (event) => {
            if (event.key === 'fecha-proxima-actualizada') {
                console.log('Fecha actualizada desde administrador, recargando...');
                setTimeout(cargarFechaProxima, 500);
            }
        });
    }

})();
</script>


</body>

</html>
